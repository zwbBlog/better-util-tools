!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).BetterUtilTools=t()}(this,(function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=i(e);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(t=e))throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(this,t?(n=i(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments))}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(){function n(){t(this,n)}return r(n,[{key:"arrayEqual",value:function(e,t){if(e!==t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1}return!0}},{key:"isEmptyObj",value:function(e){return"{}"===JSON.stringify(e)||0===Object.keys(e).length}},{key:"typeIs",value:function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}},{key:"hasClass",value:function(e,t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)}},{key:"addClass",value:function(e,t){this.hasClass(e,t)||(e.className+=" "+t)}},{key:"removeClass",value:function(e,t){this.hasClass(e,t)&&(t=new RegExp("(\\s|^)"+t+"(\\s|$)"),e.className=e.className.replace(t," "))}},{key:"getExplore",value:function(){var e,t={},n=navigator.userAgent.toLowerCase();return(e=(e=n.match(/rv:([\d.]+)\) like gecko/))||n.match(/msie ([\d\.]+)/))?t.ie=e[1]:(e=n.match(/edge\/([\d\.]+)/))?t.edge=e[1]:(e=n.match(/firefox\/([\d\.]+)/))?t.firefox=e[1]:(e=n.match(/(?:opera|opr).([\d\.]+)/))?t.opera=e[1]:(e=n.match(/chrome\/([\d\.]+)/))?t.chrome=e[1]:(e=n.match(/version\/([\d\.]+).*safari/))&&(t.safari=e[1]),t.ie?"IE: "+t.ie:t.edge?"EDGE: "+t.edge:t.firefox?"Firefox: "+t.firefox:t.chrome?"Chrome: "+t.chrome:t.opera?"Opera: "+t.opera:t.safari?"Safari: "+t.safari:"Unkonwn"}},{key:"getOS",value:function(){"navigator"in window&&"userAgent"in navigator&&navigator.userAgent.toLowerCase(),"navigator"in window&&"vendor"in navigator&&navigator.vendor.toLowerCase();var e="navigator"in window&&"appVersion"in navigator&&navigator.appVersion.toLowerCase()||"";return/mac/i.test(e)?"MacOSX":/win/i.test(e)?"windows":/linux/i.test(e)?"linux":void 0}},{key:"getMobileSys",value:function(){var e="navigator"in window&&"userAgent"in navigator&&navigator.userAgent.toLowerCase()||"";return/iphone/i.test(e)||/ipad/i.test(e)||/ipod/i.test(e)?"ios":/android/i.test(e)?"android":/win/i.test(appVersion)&&/phone/i.test(e)?"windowsPhone":void 0}},{key:"getWechatEnv",value:function(){var e="navigator"in window&&"userAgent"in navigator&&navigator.userAgent.toLowerCase()||"";return"micromessenger"===e.match(/MicroMessenger/i)&&"wxwork"===e.match(/wxwork/i)?"enterprise":"micromessenger"===e.match(/micromessenger/i)?"wechat":void 0}},{key:"getClient",value:function(){return navigator.userAgent.match(/(iPhone|iPod|Android|ios|iOS|iPad|Backerry|WebOS|Symbian|Windows Phone|Phone)/i)?"mobile":"pc"}},{key:"randomColor",value:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)}},{key:"colorToRGB",value:function(e,t){var n="number"==typeof t;if(!/^(#?)[a-fA-F0-9]{6}$/.test(e))return"";for(var r=e.replace(/#/,""),o=[],i=0;i<3;i++){var a=r.substring(2*i,2*i+2);a=parseInt(a,16);o.push(a)}return"rgb"+(n?"a":"")+"("+o.join()+(n?","+t:"")+")"}},{key:"random",value:function(e,t){return t=t-e+1,Math.floor(Math.random()*t+e)}},{key:"randomName",value:function(e,t,n){var r="",o=t,i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];e&&(o=Math.floor(Math.random()*(n-t+1)+t));for(var a=0;a<o;a++)r+=i[Math.round(Math.random()*(i.length-1))];return r}},{key:"isIdCard",value:function(e){return/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/.test(e)}},{key:"isPhoneNum",value:function(e){return/^(0|86|17951)?(1[3456789][0-9])[0-9]{8}$/.test(e)}},{key:"isUrl",value:function(e){return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/i.test(e)}},{key:"isEmail",value:function(e){return/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/i.test(e)}},{key:"isChineseName",value:function(e){return/^([\u4E00-\u9FFF]|\w)$/.test(e)}},{key:"isDate",value:function(e){return(e=new Date(e))instanceof Date&&!isNaN(e.getTime())}},{key:"download",value:function(e){var t=-1<navigator.userAgent.toLowerCase().indexOf("chrome"),n=-1<navigator.userAgent.toLowerCase().indexOf("safari");return(t||n)&&((t=document.createElement("a")).href=e,void 0!==t.download&&(n=e.substring(e.lastIndexOf("/")+1,e.length),t.download=n),document.createEvent)?((n=document.createEvent("MouseEvents")).initEvent("click",!0,!0),t.dispatchEvent(n),!0):(-1===e.indexOf("?")&&(e+="?download"),window.open(e,"_self"),!0)}},{key:"elementIsVisibleInViewport",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=(e=e.getBoundingClientRect()).top,r=e.left,o=e.bottom,i=(e=e.right,(a=window).innerHeight),a=a.innerWidth;return t?(0<n&&n<i||0<o&&o<i)&&(0<r&&r<a||0<e&&e<a):0<=n&&0<=r&&o<=i&&e<=a}},{key:"removeHtmlTag",value:function(e){return e.replace(/<[^>]+>/g,"")}},{key:"loadResources",value:function(e,t){var n=new Map,r=[],o=this.typeIs(e);function i(e,t){var r,o;o=e,n.get("zlgb"+o)!==o?(".js"==(r=(o=null)!=(r=e)&&0<r.length?r.substr(r.lastIndexOf(".")).toLowerCase():"")?(o=document.createElement("script")).src=e:".css"==r?((o=document.createElement("link")).href=e,o.type="text/css",o.rel="stylesheet"):".less"==r&&((o=document.createElement("link")).href=e,o.type="text/css",o.rel="stylesheet/less"),t=t||function(){},o.onload=o.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(n.set("zlgb"+e,e),t())},document.getElementsByTagName("head")[0].appendChild(o)):t()}if(["string","array"].includes(o)){"string"===o&&(r=e.split(",")),"array"===o&&(r=this.deepCopy(e));for(var a=0,u=0;u<r.length;u++)i(r[u],(function(){++a===r.length&&(n.clear(),t())}))}}},{key:"copyTextToClipboard",value:function(e,t){var n=document.createElement("textarea");n.style.background="transparent",n.value=e,document.body.appendChild(n),n.select();try{document.execCommand("copy")&&t&&t()}catch(e){}document.body.removeChild(n)}},{key:"numberToChinese",value:function(e){for(var t=["零","一","二","三","四","五","六","七","八","九","十"],n=["","十","百","仟","萬","億","点",""],r=String(e).replace(/(^0*)/g,"").split("."),o=0,i="",a=r[0].length-1;0<=a;a--){switch(o){case 0:i=n[7]+i;break;case 4:new RegExp("0{4}//d{"+(r[0].length-a-1)+"}$").test(r[0])||(i=n[4]+i);break;case 8:i=n[5]+i,n[7]=n[5],o=0}o%4==2&&0!=r[0].charAt(a+2)&&0==r[0].charAt(a+1)&&(i=t[0]+i),0!=r[0].charAt(a)&&(i=t[r[0].charAt(a)]+n[o%4]+i),o++}if(1<r.length)for(i+=n[6],a=0;a<r[1].length;a++)i+=t[r[1].charAt(a)];return(i="一十"==i?"十":i).match(/^一/)&&3==i.length?i.replace("一",""):i}},{key:"add",value:function(e,t,n){try{r=e.toString().split(".")[1].length}catch(e){r=0}try{o=t.toString().split(".")[1].length}catch(e){o=0}var r=Math.max(r,o),o=Math.pow(10,r);e=Number(((e*o+t*o)/o).toFixed(r));return 0<=n?this.toFixed(e,n):e}},{key:"cut",value:function(e,t,n){try{r=e.toString().split(".")[1].length}catch(e){r=0}try{o=t.toString().split(".")[1].length}catch(e){o=0}var r=Math.max(r,o),o=Math.pow(10,r);e=Number(((e*o-t*o)/o).toFixed(r));return 0<=n?this.toFixed(e,n):e}},{key:"mul",value:function(e,t,n){var r=0;e=e.toString(),t=t.toString();try{r+=e.split(".")[1].length}catch(e){}try{r+=t.split(".")[1].length}catch(e){}return e=Number(e.replace(".",""))*Number(t.replace(".",""))/Math.pow(10,r),0<=n?this.toFixed(e,n):e}},{key:"div",value:function(e,t,n){var r=0,o=0;try{r=e.toString().split(".")[1].length}catch(e){}try{o=t.toString().split(".")[1].length}catch(e){}return e=Number(e.toString().replace(".",""))/Number(t.toString().replace(".",""))*Math.pow(10,o-r),0<=n?this.toFixed(e,n):e}},{key:"continuityAdd",value:function(){var e=this,t=1<arguments.length?arguments[1]:void 0,n=0;return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(r){try{n=e.add(n,r,t)}catch(r){}})),n}},{key:"continuityCut",value:function(){var e=this,t=1<arguments.length?arguments[1]:void 0,n=0;return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(r,o){try{n=0===o?r:e.cut(n,r,t)}catch(r){}})),n}},{key:"continuityMul",value:function(){var e=this,t=1<arguments.length?arguments[1]:void 0,n=0;return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(r,o){try{n=0===o?r:e.mul(n,r,t)}catch(r){}})),n}},{key:"continuityDiv",value:function(){var e=this,t=1<arguments.length?arguments[1]:void 0,n=0;return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(r,o){try{n=0===o?r:e.div(n,r,t)}catch(r){}})),n}},{key:"toFixed",value:function(e,t){var n=this.typeIs(e);return"number"===n||"string"===n&&!window.isNaN(Number(e))?(n=-1<(e=String(e)).indexOf(".")?e.indexOf(".")+t+1:e.length,Number(e.substr(0,n))):new Error(e+"不是合法的")}},{key:"digitUppercase",value:function(e){for(var t=["角","分"],n=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],r=[["元","万","亿"],["","拾","佰","仟"]],o=e<0?"欠":"",i=(e=Math.abs(e),""),a=0;a<t.length;a++)i+=(n[Math.floor(this.mul(e,10*Math.pow(10,a)))%10]+t[a]).replace(/零./,"");i=i||"整",e=Math.floor(e);for(var u=0;u<r[0].length&&0<e;u++){for(var s="",c=0;c<r[1].length&&0<e;c++)s=n[e%10]+r[1][c]+s,e=Math.floor(e/10);i=s.replace(/(零.)*零$/,"").replace(/^$/,"零")+r[0][u]+i}return o+i.replace(/(零.)*零元/,"元").replace(/(零.)+/g,"零").replace(/^整$/,"零元整")}},{key:"getStyle",value:function(e,t){var n=e.ownerDocument?e.ownerDocument.defaultView:window;if("string"==typeof t)return n.getComputedStyle(e)[t];if(void 0===t)return n.getComputedStyle(e);if(t instanceof Array){var r,o={},i=function(e,t){var n,r,o,i,a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return r=!(n=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return n=e.done,e},e:function(e){r=!0,o=e},f:function(){try{n||null==a.return||a.return()}finally{if(r)throw o}}};if(Array.isArray(e)||(a=function(e,t){var n;if(e)return"string"==typeof e?s(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return a&&(e=a),i=0,{s:t=function(){},n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;o[a]=n.getComputedStyle(e)[a]}}catch(e){i.e(e)}finally{i.f()}return o}}},{key:"formatDecimals",value:function(e){return(e=String(e).split("."))[0]=e[0].replace(new RegExp("(\\d)(?=(\\d{3})+$)","ig"),"$1,"),e.join(".")}},{key:"formatRemainTime",value:function(e){var t=new Date,n=(e=new Date(e).getTime()-t.getTime(),t=0,0),r=0,o=0;return 0<=e&&(t=Math.floor(e/1e3/3600/24),n=Math.floor(e/1e3/60/60%24),r=Math.floor(e/1e3/60%60),o=Math.floor(e/1e3%60)),t+"天 "+n+"小时 "+r+"分钟 "+o+"秒"}},{key:"getBJDate",value:function(e){var t=e&&"date"===this.typeIs(new Date(e))?new Date(e):new Date,n=(e=e&&"date"===this.typeIs(new Date(e))?new Date(e):new Date).getHours();return(t=-t.getTimezoneOffset()/60)<0?(t=Math.abs(t)+8,e.setHours(n+t)):e.setHours(n-(t-=8)),e}},{key:"transformTimeZone",value:function(e){var t=void 0===(t=e.timezone)?8:t,n=(e=e.date,new Date(e).getTimezoneOffset());e=new Date(e).getTime();return new Date(e+60*n*1e3+60*t*60*1e3)}},{key:"formatDateTime",value:function(e){var t=e.date,n=void 0===(r=e.type)?"YYYY/MM/DD hh:mm:ss":r,r=void 0===(r=e.timeZoneBJ)||r,o=(e=(e.log,new RegExp("(d{4})-(d{1,2})-(d{1,2}) (d{1,2}):(d{1,2}):(d{1,2})","g")),e=(t&&"string"===this.typeIs(t)&&(t=t.replace(e,"$1/$2/$3 $4:$5:$6")),new Date(t||Date.now())),t=void 0!==t&&!t,this.isDate(e)&&"date"===this.typeIs(e));if(t||!o)return"";var i,a={"Y+":(e=r?this.getBJDate(e):e).getFullYear(),"M+":e.getMonth()+1,"D+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":(e.getMonth()+3)/3|0,S:e.getMilliseconds()};for(i in a)!function(e){new RegExp("("+e+")").test(n)&&(n=n.replace(RegExp.$1,(function(t,n){return(0!==n||n<10)&&String(a[e]).length<2&&2===t.length?"0".concat(a[e]):a[e]})))}(i);return n}},{key:"getMonthMaxDay",value:function(e,t){return new Date(e,t,0).getDate()}},{key:"getWeek",value:function(e,t,n){return new Date(e+"/"+t+"/"+n).getDay()}},{key:"getMonthData",value:function(e,t){if(0<e&&1<=t&&t<=12){for(var n=1,r=new Date(e,t,0).getDate(),o=[];n<r+1;n++)o.push({year:e,month:t,day:n,week:this.getWeek(e,t,n)});return o}return[]}},{key:"getAbsoluteDay",value:function(e){function t(e){var t=e;return 1==e.toString().length?"0"+e:t}e=(r=new Date).getTime()+864e5*e,r.setTime(e),e=r.getFullYear();var n=r.getMonth(),r=r.getDate();return e+"-"+t(n+1)+"-"+t(r)}},{key:"isBankCard",value:function(e,t,n){t="https://ccdcapi.alipay.com/validateAndCacheCardInfo.json?_input_charset=utf-8&cardNo=".concat(t,"&cardBinCheck=true"),e?e.get(t).then((function(e){e=e.data,n&&n(e)})).catch((function(e){n("验证失败")})):n("需要axios依赖")}},{key:"getUrlParams",value:function(e){var t={},n=[],r=[];if(this.isUrl(e)&&-1!==e.indexOf("?")){for(var o=e.substr(e.indexOf("?")+1).split("&"),i=0;i<o.length;i++){var a=o[i].split("=")[0],u=unescape(o[i].split("=")[1]);t[a]=u,n.push(a),r.push(u)}t["$#key"]=n,t["$#value"]=r}return t}},{key:"queryString",value:function(e){var t,n="";for(t in e)["string","number","boolean"].includes(this.typeIs(e[t]))?n+="".concat(t,"=").concat(encodeURIComponent(e[t]),"&"):n+="".concat(t,"=").concat(encodeURIComponent(JSON.stringify(e[t])),"&");return n.substr(0,n.length-1)}},{key:"throttle",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:50,n=0;return function(){var r=Date.now();if(t<r-n){n=r;for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];e.apply(this,i)}}}},{key:"debounce",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:50,n=null;return function(){for(var r=this,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];n&&clearTimeout(n),n=setTimeout((function(){e.apply(r,i)}),t)}}},{key:"toHump",value:function(e){return e.replace(/\_(\w)/g,(function(e,t){return t.toUpperCase()}))}},{key:"toLine",value:function(e){return e.replace(/([A-Z])/g,"_$1").toLowerCase()}},{key:"imgChange",value:function(e,t){var n=new FileReader;n.onload=function(e){e=e.target.result,t&&t(e)},n.readAsDataURL(e.files[0])}},{key:"deepCopy",value:function(t){var n="array"===this.typeIs(t)?[]:{},r=["array","object"];if(!r.includes(this.typeIs(t)))return t;var o,i=t;for(o in i)i.hasOwnProperty(o)&&("object"===e(i[o])&&r.includes(this.typeIs(i[o]))?n[o]=this.deepCopy(i[o]):n[o]=i[o]);return n}},{key:"jsonHasKey",value:function(t,n){var r=this;return"object"===e(t)&&"string"==typeof n&&Object.keys(t).some((function(e){return e===n||r.jsonHasKey(t[e],n)}))}},{key:"unique",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=[],o=0;o<e.length;o++)!function(){var i=e[o];t?0===r.filter((function(e){return e[n]===i[n]})).length&&r.push(i):-1===r.indexOf(i)&&r.push(i)}();return r}},{key:"contains",value:function(e,t){return-1!=e.indexOf(t)}},{key:"union",value:function(e,t){return e=e.concat(t),this.unique(e)}},{key:"intersect",value:function(e,t){for(var n=this,r=(e=this.unique(e)).map((function(e){return n.contains(t,e)?e:null})).filter((function(e){return e})),o=0,i=r.length;o<i;o++)null===r[o]&&r.splice(o,1);return r}},{key:"extend",value:function(){for(var e={},t=!1,n=0,r=("boolean"===this.typeIs(arguments[0])&&(t=arguments[0],n++),function(n){for(var r in n)n.hasOwnProperty(r)&&("object"===this.typeIs(n[r])?e[r]=t?this.extend(e[r],n[r]):n[r]:e[r]=n[r])}.bind(this));n<arguments.length;n++)r(arguments[n]);return e}}]),n}(),l=new(function(){function e(){t(this,e),this.events={}}return r(e,[{key:"on",value:function(e,t){this.events[e]?this.events[e].push(t):this.events[e]=[t]}},{key:"emit",value:function(e,t){this.events[e]&&this.events[e].forEach((function(e){return e(t)}))}},{key:"removeListener",value:function(e,t){this.events[e]&&(this.events[e]=this.events[e].filter((function(e){return e!==t})))}},{key:"once",value:function(e,t){var n=this;this.on(e,(function r(){t(),n.removeListener(e,r)}))}}]),e}()),f=new(function(){o(n,c);var e=u(n);function n(){return t(this,n),e.call(this)}return r(n,[{key:"fileToBase64",value:function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))}},{key:"blobToFile",value:function(e,t){return e.lastModifiedDate=new Date,e.name=t,e}},{key:"base64ToFile",value:function(e,t){for(var n=(e=e.split(","))[0].match(/:(.*?);/)[1],r=n.split("/")[1],o=atob(e[1]),i=o.length,a=new Uint8Array(i);i--;)a[i]=o.charCodeAt(i);return new File([a],"".concat(t,".").concat(r),{type:n})}},{key:"base64ToBlob",value:function(e){for(var t=(e=e.split(","))[0].match(/:(.*?);/)[1],n=atob(e[1]),r=n.length,o=new Uint8Array(r);r--;)o[r]=n.charCodeAt(r);return new Blob([o],{type:t})}},{key:"getObjectURL",value:function(e){return window.URL?window.URL.createObjectURL(e):window.webkitURL?window.webkitURL.createObjectURL(e):void 0}},{key:"streamToFile",value:function(e){var t=void 0===(t=e.res)?{}:t,n=void 0!==(n=e.preview)&&n,r=e.success;e=e.fail;if(this.isEmptyObj(t))throw new Error("请传入正确的response参数");var o,i,a,u=void 0===(u=(i=void 0===(i=t.headers)?{}:i).msg)?"文件下载失败,请检查response参数是否正确":u;if(a=void 0!==(a=i.down)&&a)return window.open(decodeURIComponent(a),"_blank");i["content-disposition"]?(a=i["content-disposition"],i=i["content-type"],a&&(-1<a.indexOf("filename*=UTF-8''")?o=a.split(";")[1].split("filename*=UTF-8''")[1].replace(/"/g,""):-1<a.indexOf("filename=")&&(o=a.split(";")[1].split("filename=")[1].replace(/"/g,""))),o=decodeURIComponent(o),a=new Blob([t.data],{type:i}),t=this.getObjectURL(a),window.navigator.msSaveOrOpenBlob?navigator.msSaveBlob(a,o):(i=document.createElement("a"),n?i.target="_blank":i.download=o,i.href=t,document.body.append(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(t)),r&&r()):e&&e(decodeURIComponent(u))}}]),n}());function d(e,t,n,r){return r=6<r||void 0===r?6:r,0==(e=(e=void 0===e||""==e?0:parseFloat(e))+(t=void 0===t||""==t?0:parseFloat(t)/60)+(n=void 0===n||""==n?0:parseFloat(n)/3600))?"":e.toFixed(r)}function h(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(e),r=n.length,o=(t=new ArrayBuffer(r),new Uint8Array(t)),i=0;i<r;i++)o[i]=n.charCodeAt(i);return t}function g(e,t,n){for(var r="",o=t;o<t+n;o++)r+=String.fromCharCode(e.getUint8(o));return r}function p(e,t,n,r,o){for(var i,a=e.getUint16(n,!o),u={},s=0;s<a;s++)u[r[e.getUint16(i=n+12*s+2,!o)]]=function(e,t,n,r){var o,i,a,u,s,c,l=e.getUint16(t+2,!r),f=e.getUint32(t+4,!r),d=e.getUint32(t+8,!r)+n;switch(l){case 1:case 7:if(1==f)return e.getUint8(t+8,!r);for(o=4<f?d:t+8,i=[],u=0;u<f;u++)i[u]=e.getUint8(o+u);return i;case 2:return g(e,o=4<f?d:t+8,f-1);case 3:if(1==f)return e.getUint16(t+8,!r);for(o=2<f?d:t+8,i=[],u=0;u<f;u++)i[u]=e.getUint16(o+2*u,!r);return i;case 4:if(1==f)return e.getUint32(t+8,!r);for(i=[],u=0;u<f;u++)i[u]=e.getUint32(d+4*u,!r);return i;case 5:if(1==f)return s=e.getUint32(d,!r),c=e.getUint32(d+4,!r),(a=new Number(s/c)).numerator=s,a.denominator=c,a;for(i=[],u=0;u<f;u++)s=e.getUint32(d+8*u,!r),c=e.getUint32(d+4+8*u,!r),i[u]=new Number(s/c),i[u].numerator=s,i[u].denominator=c;return i;case 9:if(1==f)return e.getInt32(t+8,!r);for(i=[],u=0;u<f;u++)i[u]=e.getInt32(d+4*u,!r);return i;case 10:if(1==f)return e.getInt32(d,!r)/e.getInt32(d+4,!r);for(i=[],u=0;u<f;u++)i[u]=e.getInt32(d+8*u,!r)/e.getInt32(d+4+8*u,!r);return i}}(e,i,t,o);return u}var m={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},y={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},v={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},w={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},S={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},b={getImageData:function(t){return new Promise((function(n,r){function o(e){var t=function(e){var t=new DataView(e);if(255!=t.getUint8(0)||216!=t.getUint8(1))return!1;for(var n=2,r=e.byteLength;n<r;){if(255!=t.getUint8(n))return!1;if(225==t.getUint8(n+1))return function(e,t){if("Exif"!=g(e,t,4))return!1;var n,r,o,i,a;t+=6;if(18761==e.getUint16(t))n=!1;else{if(19789!=e.getUint16(t))return!1;n=!0}if(42!=e.getUint16(t+2,!n))return!1;var u=e.getUint32(t+4,!n);if(u<8)return!1;if((r=p(e,t,t+u,m,n)).ExifIFDPointer)for(o in i=p(e,t,t+r.ExifIFDPointer,S,n)){switch(o){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":i[o]=w[o][i[o]];break;case"ExifVersion":case"FlashpixVersion":i[o]=String.fromCharCode(i[o][0],i[o][1],i[o][2],i[o][3]);break;case"ComponentsConfiguration":i[o]=w.Components[i[o][0]]+w.Components[i[o][1]]+w.Components[i[o][2]]+w.Components[i[o][3]]}r[o]=i[o]}if(r.GPSInfoIFDPointer)for(o in a=p(e,t,t+r.GPSInfoIFDPointer,y,n))"GPSVersionID"===o&&(a[o]=a[o][0]+"."+a[o][1]+"."+a[o][2]+"."+a[o][3]),r[o]=a[o];return r.thumbnail=function(e,t,n,r){return n=function(e,t,n){var r=e.getUint16(t,!n);return e.getUint32(t+2+12*r,!n)}(e,t+n,r),n?n>e.byteLength?{}:((e=p(e,t,t+n,v,r)).Compression?6===e.Compression&&e.JpegIFOffset&&e.JpegIFByteCount&&(e.JpegIFOffset,e.JpegIFByteCount):e.PhotometricInterpretation,e):{}}(e,t,u,n),r}(t,n+4,t.getUint16(n+2));n+=2+t.getUint16(n+2)}}(e);e=function(e){var t=new DataView(e);if(255!=t.getUint8(0)||216!=t.getUint8(1))return!1;for(var n=2,r=e.byteLength;n<r;){var o,i;if(function(e,t){return 56===e.getUint8(t)&&66===e.getUint8(t+1)&&73===e.getUint8(t+2)&&77===e.getUint8(t+3)&&4===e.getUint8(t+4)&&4===e.getUint8(t+5)}(t,n))return(i=t.getUint8(n+7))%2!=0&&(i+=1),o=n+8+(i=0===i?4:i),i=t.getUint16(n+6+i),readIPTCData(e,o,i);n++}}(e);n({exif:t||{},iptc:e||{}})}var i,a,u,s,c;/^data\:/i.test(t)?o(h(t)):/^blob\:/i.test(t)?((i=new FileReader).onload=function(e){o(e.target.result)},u=t,s=function(e){i.readAsArrayBuffer(e)},(c=new XMLHttpRequest).open("GET",u,!0),c.responseType="blob",c.onload=function(e){200!=this.status&&0!==this.status||s(this.response)},c.send()):"object"===("undefined"==typeof window?"undefined":e(window))&&"document"in window?((a=new XMLHttpRequest).onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";o(a.response),a=null},a.open("GET",t,!0),a.responseType="arraybuffer",a.send(null)):"object"===("undefined"==typeof plus?"undefined":e(plus))?plus.io.resolveLocalFileSystemURL(function(e){if(0===e.indexOf("_www")||0===e.indexOf("_doc")||0===e.indexOf("_documents")||0===e.indexOf("_downloads"))return e;if(0===e.indexOf("file://"))return e;if(0===e.indexOf("/storage/emulated/0/"))return e;if(0===e.indexOf("/")){var t=plus.io.convertAbsoluteFileSystem(e);if(t!==e)return t;e=e.substr(1)}return"_www/"+e}(t),(function(e){e.file((function(e){var t=new plus.io.FileReader;t.onload=function(e){o(h(e.target.result))},t.onerror=function(e){r(e)},t.readAsDataURL(e)}),(function(e){r(e)}))}),(function(e){r(e)})):"object"===("undefined"==typeof wx?"undefined":e(wx))&&wx.canIUse("getFileSystemManager")?wx.getFileSystemManager().readFile({filePath:t,success:function(e){o(e.data)},fail:function(e){r(e)}}):r(new Error("not support"))}))},getFloatLocationByExif:function(e){return e.GPSLatitude&&e.GPSLongitude?{lat:("S"==e.GPSLatitudeRef?-1:1)*d(e.GPSLatitude[0],e.GPSLatitude[1],e.GPSLatitude[2]),lon:("W"==e.GPSLongitudeRef?-1:1)*d(e.GPSLongitude[0],e.GPSLongitude[1],e.GPSLongitude[2])}:null}};return function(){o(n,c);var e=u(n);function n(r){var o;return t(this,n),(o=e.call(this,r)).EventEmitter=l,o.options=r||{},o.file=f,o.izExif=b,o}return r(n)}()}));
